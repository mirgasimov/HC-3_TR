# –ú–∏—Ä–≥–∞—Å–∏–º–æ–≤ –∏ –§—Ä–æ–ª–æ–≤ 
### 15.27–í-–ü–ò12/24–º 
### –¢–í–û–†–ß–ï–°–ö–ò–ô –†–ï–ô–¢–ò–ù–ì –ù–°-3
# [–°—Å—ã–ª–∫–∞ –Ω–∞ Google Colab](https://colab.research.google.com/drive/1HmZOucQqlpSuVmqQRNPA2PGlQg4vK_lE)
# [–ö–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏](https://github.com/mirgasimov/HC-3_TR/blob/main/%D0%BC%D0%B8%D1%80%D0%B3%D0%B0%D1%81%D0%B8%D0%BC%D0%BE%D0%B2_%D1%84%D1%80%D0%BE%D0%BB%D0%BE%D0%B2(15_27%D0%B2_%D0%BF%D0%B812_24%D0%BC)_%D1%82%D0%B2%D0%BE%D1%80%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D1%80%D0%B5%D0%B9%D1%82%D0%B8%D0%BD%D0%B3.py)
# [–î–∞–Ω–Ω—ã—Ö MNIST](https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz)

### –ë—ã–ª–æ
> –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:  0.9786999821662903
> ![image](https://github.com/user-attachments/assets/89f80b66-7ee9-4274-886b-1ba7c8e491b8)
### –°—Ç–∞–ª–æ
> –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: 0.9824000000953674
![image](https://github.com/user-attachments/assets/2f1a2abc-48bd-471f-a135-a4194f9cf1d8)


### –ë—ã–ª–æ: 0.9787
![image](https://github.com/user-attachments/assets/a2003a7b-d24d-493a-a02f-49a52503f7d2)


### –°—Ç–∞–ª–æ: 0.9824
![image](https://github.com/user-attachments/assets/65c11db5-291d-4b63-94ce-b29a4591581d)


> –ò—Ç–æ–≥: —Ç–æ—á–Ω–æ—Å—Ç—å —É–ª—É—á—à–∏–ª–∞—Å—å –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 0.38%.
> –£–ª—É—á—à–µ–Ω–∏–µ –Ω–µ–±–æ–ª—å—à–æ–µ, –Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ.



–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –∑–∞ —Å—á—ë—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:  

### 1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—ë–≤ (Conv2D) –≤–º–µ—Å—Ç–æ Dense**
#### **–î–æ**:
- –í—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–µ–≤—Ä–∞—â–∞–ª–∏—Å—å –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä (Flatten) –∏ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –≤ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ (Dense) —Å–ª–æ–∏.
- –≠—Ç–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —á—Ç–æ —Å–Ω–∏–∂–∞–ª–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

#### **–ü–æ—Å–ª–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ (Conv2D), –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- –ú–∞–∫—Å–ø—É–ª–∏–Ω–≥ (MaxPooling2D) —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, –≤—ã–¥–µ–ª—è—è –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
---

### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
#### **–î–æ**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –∏—Å—Ö–æ–¥–Ω—ã–π –Ω–∞–±–æ—Ä –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

#### **–ü–æ—Å–ª–µ**:
```python
datagen = ImageDataGenerator(
    rotation_range=10,
    width_shift_range=0.1,
    height_shift_range=0.1,
    zoom_range=0.1
)
datagen.fit(train_images)
``` 
- –í—Ä–∞—â–µ–Ω–∏–µ ```rotation_range```, —Å–º–µ—â–µ–Ω–∏–µ ```width_shift_range```, ```height_shift_range```), –∑—É–º ```zoom_range``` –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏ —É–ª—É—á—à–∞–µ—Ç –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

---

### 3. **–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–æ–∏ Dropout –∏ L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è**
#### **–î–æ**:
- –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏ –±–µ–∑ —Ä–µ–≥—É–ª–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é.

#### **–ü–æ—Å–ª–µ**:
```python
Dense(256, activation='relu', kernel_regularizer=keras.regularizers.l2(0.01)),
Dropout(0.3),
Dense(128, activation='relu', kernel_regularizer=keras.regularizers.l2(0.01)),
Dropout(0.3),
``` 
- Dropout –æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω—ã –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è, —Å–Ω–∏–∂–∞—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.
- L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç —à—Ç—Ä–∞—Ñ –∑–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –≤–µ—Å–∞.

üëâ –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

---


### 4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è**
#### **–î–æ**:
```python
history = model.fit(train_images, train_labels, epochs=15, batch_size=128, validation_data=(validation_images, validation_labels))
``` 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ–±—ã—á–Ω—ã–π fit –±–µ–∑ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

#### **–ü–æ—Å–ª–µ**:
```python
history = model.fit(
    datagen.flow(train_images, train_labels, batch_size=128),
    epochs=20,
    validation_data=(validation_images, validation_labels)
)
```
- –í–º–µ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä datagen.flow().


---

## **–í—ã–≤–æ–¥**
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—ë–≤ (Conv2D + MaxPooling2D)** ‚Üí –ª—É—á—à–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –æ–±—Ä–∞–∑—ã.  
**–î–æ–±–∞–≤–ª–µ–Ω–∏—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (ImageDataGenerator)** ‚Üí —Å–Ω–∏–∂–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.  
